
-- Running tidyGWAS 0.1.0 ------------------------------------------------------
Starting at 2023-08-04 13:32:40.112731
Writing out raw sumstats

-- Performing initial checks on input data:  --

i Columns: CHR, POS, EffectAllele, OtherAllele, B, SE, EAF, INFO, P, CaseN, ControlN, and rowid
  * Scanning for NAs with tidyr::drop_na()
  v Found no rows with missing values
  * Scanning for duplicates.. If P exists, row with smallest pvalue will ke
  kept
    1. Using CHR_POS_REF_ALT as id
    v Detected 0 rows as indels

    -- Finished initial checks --

v All rows pass CHR validation
v All rows pass POS validation
v All rows pass EffectAllele validation
v All rows pass OtherAllele validation

-- No rows were removed --

-- Validating statistics columns: B, P, SE, INFO, N, CaseN, ControlN, and EAF --

i The median value of B is -0.0012, which seems reasonable
v All rows pass B validation
v All rows pass P validation
v All rows pass SE validation
v All rows pass N validation
v All rows pass EAF validation

-- No rows were removed --

-- Validating sumstats using dbSNP --

  1. Repair missing CHR, POS or RSID
  2. Remove rows where REF/ALT in dbSNP is not compatible with EffectAllele /
  OtherAllele
  3. Remove rows where rsID does not match any entry in dbSNP v.155

-- tidyGWAS::repair_rsid -------------------------------------------------------
* BSgenome package is used to acquire RSID, with CHR and POS as input
* `incompatible_alleles` flags where EffectAllele/OtherAllele does not match
REF/ALT
* `no_dbsnp_entry` flags rows without dbSNP entry
* This will likely take a few minutes...
i Inferring build by checking matches against GRCh37 and GRCh38
96 snps matched GRCh38, 9952 for GRCh37, inferring build to be 37
i CHR and POS were on GRCh37. Acquiring positions on GRCh38, by mapping to dbSNP with RSID

-- Finished validation against dbSNP v.155 --

-- Listing how many rows are removed per flag:  --

  no_dbsnp_entry: 501
  uncompatible_alleles: 0
Removed a total of 501 rows: '/var/folders/6f/ndpsm1z96js7qcvmf6vtz638stnpv6/T//RtmpSdI7G6/no_rsid/no_rsid/pipeline_info/validate_with_dbsnp.log.gz'

-- Finished tidyGWAS -----------------------------------------------------------
i A total of 501 rows were removed. Started with: 100000 rows, ended with: 99499 rows

-- Listing final breakdown of removed rows:  
  validate_with_dbsnp: 501
