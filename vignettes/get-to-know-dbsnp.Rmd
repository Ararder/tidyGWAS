---
title: "get-to-know-dbsnp"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{get-to-know-dbsnp}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(tidyGWAS)
```


dbSNP has several "issues" when you dig into the data. Here i discuss
how each issue is dealt with in tidyGWAS.

As of writing this, tidyGWAS uses dbSNP v155 to repair and validate
CHR:POS:RSID:A1:A2.

### Issue 1) - same CHR:POS can map to multiple SNPs

In this particular example, the three SNPs have been merged into
rs10157617. If you check the history tab however, you can see that this
merge happened in dbSNP 156. So - the issue has not yet been fixed in
the data tidyGWAS is using.

#### Solution

For the case where the same CHR:POS maps to multiple RSIDs, tidyGWAS
selects the RSID with the smallest rs number, to mimic how dbSNP
performs merges.

```{r}
# on GRCh38
#  CHR        POS RSID         ref_allele alt_alleles
#   <chr>    <int> <chr>        <chr>      <list>     
# 1 1     39491595 rs10157617   T          <chr [2]>  
# 2 1     39491595 rs1638449573 T          <chr [1]>  
# 3 1     39491595 rs1638449625 T          <chr [1]>  
# 4 1     39491595 rs1638449683 T          <chr [1]>  

```

### 2) Some SNPs only have CHR:POS on GRCh37

Some SNPs only have CHR and POS on GRCh37, and have not yet been mapped
to GRCh38. For these SNPs,

CHR and POS will be NA, and CHR_37 and POS_37 will be available.

### 3) some RSIDs map to multiple CHR:POS

See [here](https://www.ncbi.nlm.nih.gov/snp/docs/rs_multi_mapping/) for
NCBI discussion
